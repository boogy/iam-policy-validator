# Public Access with Conditions Configuration
# Allows public access (*) but requires strict conditions

settings:
  enable_builtin_checks: true
  fail_on_severity:
    - error
    - critical
    - high

principal_validation:
  enabled: true
  severity: high

  # Don't block public access - we'll require conditions instead
  blocked_principals: []

  # No whitelist
  allowed_principals: []

  # Require conditions for public access (using new format)
  principal_condition_requirements:
    - principals:
        - "*"  # Public access
      severity: high
      required_conditions:
        all_of:  # ALL of these conditions must be present
          - condition_key: "aws:SourceArn"
            description: "Must specify source ARN to limit public access"
          - condition_key: "aws:SourceAccount"
            description: "Must specify source account to prevent unauthorized access"

  # Allow all AWS service principals
  allowed_service_principals:
    - "aws:*"  # Allow any AWS service principal
